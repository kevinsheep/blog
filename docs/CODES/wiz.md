---
title: 为知笔记私人部署
updateTime: 2023/02/05
---

## Intro
使用过不少笔记工具，印象、有道、为知、语雀、石墨、飞书、幕布...好几个还是长时间付费使用，都各有千秋。本文不是笔记工具评测文章，就不详细展开了。

我自己使用时间最长的是[为知笔记](https://www.wiz.cn/)了，尤其最近两年重构后的版本更为简洁好用。

不过有天发现，那几十块的费用可以有不同的用法：买个最便宜的服务器，然后私有化部署一个自己的笔记服务。服务器赶上搞活动时买，不比笔记服务年费贵多少，甚至比年费还便宜！有了自己的服务器还有许多的用途，远不止部署一个笔记服务……

有了这个想法后便不可收拾了，马上动手！

为知笔记是支持个人用户白嫖的，5 用户以下免费使用。官方做好 docker 镜像并写了详细的[使用文档](https://www.wiz.cn/zh-cn/docker.html)，业界良心，点赞！

不过文档里没有详细说一下备份、恢复数据的事，或许是情况太多了，需要用户自己按实现情况来发挥。我说说自己的相关操作：

## 部署和升级

```bash
# 进入用户目录
cd ~

# 建立数据存放目录，你也可以存放到自己喜欢的地方，后面的部署指令要相应修改
mkdir wizdata 

# 用 `docker run` 是一样的
# 同一台服务器上首次部署的话，会自动拉取最新版本的镜像
# 你也可以不使用 80 端口
podman run --name wiz --restart=always -it -d -v ~/wizdata:/wiz/storage -v /etc/localtime:/etc/localtime -p 80:80 -p 9269:9269/udp wiznote/wizserver
```

以上执行成功后，就能通过服务器IP访问到自己的笔记服务前后台了。

如果重启过服务器，可以执行 `docker start wiz` 手动启动笔记服务。

如果官方发布了新镜像，想更新自己的服务的话，也很方便：

```bash
docker stop wiz
docker rm wiz
docker pull wiznote/wizserver:latest
```

然后重新在服务器上执行上面用过的部署的命令即可。

如果自己有比较好记简短的域名，绑定一个到服式器 IP，简直方便！而且如果我们一般用优惠服务品，一年左右就换服务器了，可以仍用同一个域名。

从网页端访问很方便，但显示效果和功能细节不如使用官方的专用客户端。可以到[这里](https://www.wiz.cn/zh-cn/wiznew.html)下载，支持 Ipad、Iphone、安卓、Windows、Linux 多个平台，我可以在多个平台间随时同步笔记。只需要在登录时，先指定使用私有部署服务。这时如果有绑定域名的话，就免于记忆一串IP地址了。

在 Linux 上建议使用 [AppImageLauncher](https://github.com/TheAssassin/AppImageLauncher) 来打开客户端。亲测 Ubuntu 和 Manjaro 上运行流畅、界面美观、操作便捷。

## 备份和还原
这部分内容官方文档无法一一细说，但其实十分重要。

甚至于，当你成功地部署好服务，可以方便地使用自己的私有部署笔记后，要马上尝试备份和还原操作，以确保你可以随时进行维护。没有问题后，下一步才是把自己的笔记使用迁移到这个私有平台上。毕竟数据无价，要不然用上大半年，累积了一堆文档时才发现备份搞不定，或者备份的数据无法在别处原样还原，那就是一个悲剧了。

先登录到服务器终端，然后把数据文件夹打个包，要不然全是零散的文件。压缩后，存储体积和传输时间大减。

```bash
tar zcvf wizdata.tar.gz ./wizdata
```

然后在本地电脑上把数据拉下来，现在好多终端有可视化交互，那个就不细说了，如果本地也是 Linux 系统，可以使用 `scp` 命令：

```bash
# ...替换为你的服务器地址
scp root@...:/root/wizdata.tar.gz ./
```

建议定期备份一下。备份策略自己定就可以了。

什么？自动备份？有这个意识的话，都不用我来啰嗦了，自己研究吧！

如果要在新的服务器上重新还原数据进行部署，只需要反过来操作，即把备份数据传到服务器上，解压到 `wizdata` 文件夹即可：

```bash
# ...替换为你的服务器地址
scp ./wizdata.tar.gz root@...:/root/

# 解压
tar zxvf wizdata.tar.gz
```

然后，重新执行部署命令即可！